tinymce.PluginManager.add("stopwords", function (t, n) { var r = function (t, n) { for (var r = []; -1 !== n.indexOf(t);) { var e = n.lastIndexOf(t); r.push(e), n = n.substr(0, e) } return r }; $.get("/umbraco/surface/PartialSurface/GetStopwords", function (n) { t.on("focusout", function (e) { for (var a = t.getContent(), s = n, o = 0; o < s.length; o++)for (var u = s[o], f = '<span style="background:red;">' + u + "</span>", i = r(u, a), c = 0; c < i.length; c++) { var d = i[c], g = a.substr(0, d - 2).endsWith("red;"); if (!g) { var v = u.length; a = a.substr(0, d) + f + a.substr(d + v) } } tinymce.activeEditor.setContent(a) }) }) });